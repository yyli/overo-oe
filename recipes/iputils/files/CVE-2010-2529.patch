From b2dda4bbaa44ea296f1d75acc64cace221935d0d Mon Sep 17 00:00:00 2001
From: YOSHIFUJI Hideaki <yoshfuji@linux-ipv6.org>
Date: Wed, 6 Oct 2010 20:38:42 +0900
Subject: [PATCH] ping: Fix resource consumption triggered by specially crafted ICMP Echo Reply (CVE-2010-2529)

Signed-off-by: YOSHIFUJI Hideaki <yoshfuji@linux-ipv6.org>
---
 ping.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/ping.c b/ping.c
index 4472d77..eacb29d 100644
--- a/ping.c
+++ b/ping.c
@@ -1032,7 +1032,7 @@ void pr_options(unsigned char * cp, int hlen)
				i = j;
			i -= IPOPT_MINOFF;
			if (i <= 0)
-				continue;
+				break;
			if (i == old_rrlen
			    && !strncmp((char *)cp, old_rr, i)
			    && !(options & F_FLOOD)) {
@@ -1069,7 +1069,7 @@ void pr_options(unsigned char * cp, int hlen)
				i = j;
			i -= 5;
			if (i <= 0)
-				continue;
+				break;
			flags = *++cp;
			printf("\nTS: ");
			cp++;
--
1.7.2.3
